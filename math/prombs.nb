(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     45648,       1148]
NotebookOptionsPosition[     43285,       1062]
NotebookOutlinePosition[     43674,       1079]
CellTagsIndexPosition[     43631,       1076]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Compute the successor of a triangular matrix for the prombs algorithm\
\>", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "[", "L_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"j", "\[GreaterEqual]", "i"}], ",", 
      RowBox[{"f", "[", 
       SubscriptBox["b", 
        RowBox[{"i", ",", "j"}]], "]"}], ",", "0"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"succ", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "As", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"As", "=", "A"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"As", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}], ",", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}]}]}], "]"}], "]"}], "=", 
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"As", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"As", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", "As"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4963061579158382`*^9, 3.49630626584772*^9}, {
  3.4963063307113028`*^9, 3.496306335647347*^9}, {3.4964778822924337`*^9, 
  3.49647788291962*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["ProMBS", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
  3.49630853946891*^9, 3.4963085413119097`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prombs", "[", 
   RowBox[{"A_", ",", "fe_", ",", "g_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Ar", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ar", "=", 
      RowBox[{
       RowBox[{"NestList", "[", 
        RowBox[{"succ", ",", "A", ",", "N"}], "]"}], "/.", 
       RowBox[{"f", "\[Rule]", "fe"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{
        RowBox[{"Fold", "[", 
         RowBox[{"Dot", ",", 
          RowBox[{"Ar", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Ar", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prombsExt", "[", 
   RowBox[{
   "A_", ",", "f_", ",", "g_", ",", "h_", ",", "\[Epsilon]_", ",", "N_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   FractionBox["1", "\[Epsilon]"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"prombs", "[", 
      RowBox[{"A", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", "#", "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"h", "[", "#", "]"}]}], "]"}]}], "&"}], ",", "g", ",", 
       "N"}], "]"}], "-", 
     RowBox[{"prombs", "[", 
      RowBox[{"A", ",", "f", ",", "g", ",", "N"}], "]"}]}], 
    ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.4963085572393627`*^9, 3.496308625466155*^9}, {
   3.4963087689268293`*^9, 3.49630888211731*^9}, {3.496309366158889*^9, 
   3.496309404776751*^9}, {3.4963094563184433`*^9, 3.496309511509886*^9}, {
   3.4963095626034317`*^9, 3.496309567315295*^9}, {3.4963098080454073`*^9, 
   3.496309845142528*^9}, {3.496309892775543*^9, 3.496309893887207*^9}, {
   3.496309983776401*^9, 3.4963099975387363`*^9}, {3.4963101351434917`*^9, 
   3.496310140610936*^9}, {3.496310459603875*^9, 3.496310495752667*^9}, {
   3.496310569955127*^9, 3.496310579871107*^9}, {3.496310762413344*^9, 
   3.496310764076994*^9}, 3.496313229832797*^9, {3.496469480373928*^9, 
   3.496469490007218*^9}, {3.496469548402094*^9, 3.496469551340371*^9}, {
   3.4964696679722977`*^9, 3.496469668173061*^9}, {3.496476481483364*^9, 
   3.4964764824799757`*^9}, {3.4964774369751596`*^9, 3.49647746578902*^9}, 
   3.496477832979144*^9, {3.496660171766859*^9, 3.496660178330573*^9}, {
   3.497157741751882*^9, 3.497157742594799*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
  3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
  3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
  3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
  3.496465134383539*^9}, {3.4964701664981613`*^9, 3.496470185362529*^9}, {
  3.523356169368423*^9, 3.5233561721503153`*^9}, {3.523356202246294*^9, 
  3.523356204949431*^9}, {3.523356258373147*^9, 3.52335626568329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Count", " ", "statistics"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ns", "[", "bij_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "=", 
        RowBox[{"bij", "/.", 
         RowBox[{
          SubscriptBox["b", 
           RowBox[{"i_", ",", "j_"}]], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"successes", "[", 
         RowBox[{"[", 
          RowBox[{"i", ";;", "j"}], "]"}], "]"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nf", "[", "bij_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], "=", 
        RowBox[{"bij", "/.", 
         RowBox[{
          SubscriptBox["b", 
           RowBox[{"i_", ",", "j_"}]], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"failures", "[", 
         RowBox[{"[", 
          RowBox[{"i", ";;", "j"}], "]"}], "]"}]}]}]}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.496467018603112*^9, 3.496467028839601*^9}, {
  3.496467113281349*^9, 3.496467125011794*^9}, {3.4964672294560623`*^9, 
  3.49646729640521*^9}, {3.4964673492452507`*^9, 3.496467404534198*^9}, {
  3.496467589031912*^9, 3.496467613986788*^9}, {3.4964676698460627`*^9, 
  3.496467707499886*^9}, {3.496467768815625*^9, 3.496467935722452*^9}, {
  3.496469299722822*^9, 3.496469308794485*^9}, {3.496469659144464*^9, 
  3.496469659420434*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fe", "[", "bij_", "]"}], ":=", 
  FractionBox[
   RowBox[{"Beta", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]"}], ",", 
     RowBox[{
      RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}]}], "]"}], 
   RowBox[{"Beta", "[", 
    RowBox[{"\[Sigma]", ",", "\[Gamma]"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "\"\<B\>\"", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Binomial", "[", 
       RowBox[{
        RowBox[{"L", "-", "1"}], ",", "m"}], "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", "\"\<D\>\"", "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"prombs", "[", 
     RowBox[{
      RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
      RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
      RowBox[{"L", "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.496468012971098*^9, 3.4964680390810537`*^9}, {
  3.496468385477005*^9, 3.496468393627639*^9}, {3.496468509839691*^9, 
  3.4964685257262907`*^9}, {3.4964685575060673`*^9, 3.496468661969253*^9}, {
  3.496468942602952*^9, 3.4964690502541437`*^9}, {3.496469331817041*^9, 
  3.4964693478981867`*^9}, {3.4964694025103292`*^9, 3.496469404099579*^9}, {
  3.496469777350711*^9, 3.4964697872903967`*^9}, {3.496657485528965*^9, 
  3.4966575324965277`*^9}, {3.496658763194788*^9, 3.496658779577194*^9}, {
  3.4966589926541986`*^9, 3.496658998883214*^9}, {3.496659731958558*^9, 
  3.496659737496737*^9}, {3.523356395714561*^9, 3.5233563961423473`*^9}, {
  3.5233565881435843`*^9, 3.5233565884712467`*^9}, {3.523356642099296*^9, 
  3.523356643163308*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example with binomial data", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
  3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
  3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
  3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
  3.496465134383539*^9}, {3.4964701664981613`*^9, 3.496470185362529*^9}, {
  3.5233563212675867`*^9, 3.5233563361771793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Data", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"successes", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2", ",", "4", ",", "7", ",", "7"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"failures", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"8", ",", "7", ",", "7", ",", "6", ",", "3", ",", "2"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Parameters", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", "1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"in", " ", "the", " ", 
      RowBox[{"paper", ":", " ", "\[Alpha]"}]}], " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{"\[Sigma]", ",", " ", "\[Gamma]"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.496465185995377*^9, 3.496465246422797*^9}, {
  3.4964684525607023`*^9, 3.496468475485355*^9}, {3.4964686048572893`*^9, 
  3.496468646406538*^9}, {3.4964688931399403`*^9, 3.496468894004002*^9}, {
  3.4964689331758327`*^9, 3.496468938413433*^9}, {3.496469120794979*^9, 
  3.496469120897566*^9}, {3.4964695148448772`*^9, 3.4964695149801064`*^9}, {
  3.496469827047003*^9, 3.496469829080565*^9}, {3.496657614346758*^9, 
  3.49665761530757*^9}, {3.49665900730369*^9, 3.496659007821121*^9}, {
  3.5395873244326687`*^9, 3.539587327837186*^9}, {3.539592520147296*^9, 
  3.5395925207125473`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["ProMBS test", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
  3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
  3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
  3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
  3.496465134383539*^9}, {3.4964701664981613`*^9, 3.496470185362529*^9}, {
  3.52335635188267*^9, 3.523356352048902*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "the", " ", "evidence", " ", "P", 
    RowBox[{"(", "D", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"prombs", "[", 
      RowBox[{
       RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
       RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", "L"}], "]"}], "//", "Log"}],
     "//", "N"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"prombs", "[", 
      RowBox[{
       RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
       RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{"L", "-", "1"}]}], "]"}]}], "//", "N"}]}]}]], "Input",
 CellChangeTimes->{{3.4964690583872223`*^9, 3.49646907179916*^9}, {
  3.496469124268689*^9, 3.496469129641217*^9}, {3.496469569526676*^9, 
  3.496469583971401*^9}, {3.496469676771809*^9, 3.496469697891049*^9}, {
  3.496469736483698*^9, 3.496469741943077*^9}, {3.496469801173156*^9, 
  3.49646980142127*^9}, {3.496469836352319*^9, 3.496469836775069*^9}, {
  3.496469963091135*^9, 3.49647001684402*^9}, {3.496477542516479*^9, 
  3.496477550384005*^9}, {3.496650354313772*^9, 3.496650355894565*^9}, {
  3.49665075808911*^9, 3.496650759542059*^9}, {3.496657876462961*^9, 
  3.4966578791175737`*^9}, {3.4966583463939657`*^9, 3.496658346665208*^9}, {
  3.4966587882841187`*^9, 3.496658805104665*^9}, {3.4966597276432943`*^9, 
  3.496659728047866*^9}, {3.5233567004738007`*^9, 3.523356702867805*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "41.350593477933444`"}], ",", 
   RowBox[{"-", "38.62402218832657`"}], ",", 
   RowBox[{"-", "38.642096403078824`"}], ",", 
   RowBox[{"-", "38.95228122543481`"}], ",", 
   RowBox[{"-", "39.364525912028824`"}], ",", 
   RowBox[{"-", "39.88215226199554`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.496469074941492*^9, {3.4964691307913427`*^9, 3.496469136427847*^9}, 
   3.4964693128382063`*^9, 3.49646935062358*^9, 3.496469408948124*^9, {
   3.49646949825144*^9, 3.4964695855164623`*^9}, {3.496469661857759*^9, 
   3.496469698491106*^9}, {3.49646973897338*^9, 3.496469742607951*^9}, {
   3.4964697799681997`*^9, 3.496469801992322*^9}, {3.496469834058777*^9, 
   3.496469837327491*^9}, 3.4964700174255*^9, 3.496476518949915*^9, 
   3.496477550929245*^9, 3.496650356467927*^9, 3.496650477168098*^9, 
   3.4966507154928637`*^9, 3.496650760017446*^9, {3.496657489367127*^9, 
   3.4966575339080467`*^9}, 3.496657618362762*^9, 3.496657879899836*^9, {
   3.496658347325145*^9, 3.496658350175942*^9}, {3.4966587815758543`*^9, 
   3.49665880576748*^9}, 3.496659745208693*^9, 3.4966606164957933`*^9, 
   3.503748696982148*^9, 3.5233567036954803`*^9}],

Cell[BoxData["5.935033999003864`*^-17"], "Output",
 CellChangeTimes->{
  3.496469074941492*^9, {3.4964691307913427`*^9, 3.496469136427847*^9}, 
   3.4964693128382063`*^9, 3.49646935062358*^9, 3.496469408948124*^9, {
   3.49646949825144*^9, 3.4964695855164623`*^9}, {3.496469661857759*^9, 
   3.496469698491106*^9}, {3.49646973897338*^9, 3.496469742607951*^9}, {
   3.4964697799681997`*^9, 3.496469801992322*^9}, {3.496469834058777*^9, 
   3.496469837327491*^9}, 3.4964700174255*^9, 3.496476518949915*^9, 
   3.496477550929245*^9, 3.496650356467927*^9, 3.496650477168098*^9, 
   3.4966507154928637`*^9, 3.496650760017446*^9, {3.496657489367127*^9, 
   3.4966575339080467`*^9}, 3.496657618362762*^9, 3.496657879899836*^9, {
   3.496658347325145*^9, 3.496658350175942*^9}, {3.4966587815758543`*^9, 
   3.49665880576748*^9}, 3.496659745208693*^9, 3.4966606164957933`*^9, 
   3.503748696982148*^9, 3.523356703699995*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"prombsExt", "[", 
    RowBox[{
     RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
     RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"fe", "[", "#", "]"}], "]"}]}], "&"}], ",", "0.0001", ",", 
     "L"}], "]"}], "//", "Log"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.4966601191951437`*^9, 3.496660160447628*^9}, {
   3.496660218081278*^9, 3.4966602228411207`*^9}, 3.496661240036456*^9, {
   3.52335670855105*^9, 3.523356708842333*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "37.626438461896704`"}], ",", 
   RowBox[{"-", "34.984185444812006`"}], ",", 
   RowBox[{"-", "34.99316703641477`"}], ",", 
   RowBox[{"-", "35.291831933783655`"}], ",", 
   RowBox[{"-", "35.69213472309695`"}], ",", 
   RowBox[{"-", "36.194228579545644`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.496660624012628*^9, 3.496661240714945*^9, 
  3.503748699644043*^9, 3.5233567119616137`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential Entropy", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
  3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
  3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
  3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
  3.496465134383539*^9}, {3.4964702841062937`*^9, 3.496470382443359*^9}, {
  3.496470438598978*^9, 3.496470483069792*^9}, {3.496471059569688*^9, 
  3.496471071910974*^9}, {3.496479272590764*^9, 3.496479272955422*^9}, {
  3.496661624522215*^9, 3.496661632010087*^9}, {3.503748748854292*^9, 
  3.5037487589732323`*^9}, {3.52336280669567*^9, 3.523362813420991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Single", " ", "bin", " ", "entropy"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"H", "[", "bij_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"Beta", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]"}], ",", 
        RowBox[{
         RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}]}], "]"}], "]"}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]", "+", 
        RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]", "-", "2"}], ")"}], 
      RowBox[{"PolyGamma", "[", 
       RowBox[{
        RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]", "+", 
        RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]", "-", "1"}], ")"}], 
      RowBox[{"PolyGamma", "[", 
       RowBox[{
        RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]", "-", "1"}], ")"}], 
      RowBox[{"PolyGamma", "[", 
       RowBox[{
        RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}], "]"}]}]}], "//", 
    "N"}]}]}]], "Input",
 CellChangeTimes->{{3.503749288817563*^9, 3.503749289823285*^9}, {
   3.503749427775502*^9, 3.5037494970228252`*^9}, {3.503749958269889*^9, 
   3.503750004577463*^9}, {3.50375011199576*^9, 3.5037501400327597`*^9}, {
   3.5037503007671413`*^9, 3.5037503806361437`*^9}, {3.503750591882842*^9, 
   3.503750596342092*^9}, 3.523356384774189*^9, {3.5233566155653677`*^9, 
   3.523356638314625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"prombsExt", "[", 
     RowBox[{
      RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
      RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", "H", ",", "0.00000000001", 
      ",", 
      RowBox[{"L", "-", "1"}]}], "]"}]}], "/", 
   RowBox[{"Plus", "@@", 
    RowBox[{"prombs", "[", 
     RowBox[{
      RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
      RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
      RowBox[{"L", "-", "1"}]}], "]"}]}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.4964690583872223`*^9, 3.49646907179916*^9}, {
   3.496469124268689*^9, 3.496469129641217*^9}, {3.496469569526676*^9, 
   3.496469583971401*^9}, {3.496469676771809*^9, 3.496469697891049*^9}, {
   3.496469736483698*^9, 3.496469741943077*^9}, {3.496469801173156*^9, 
   3.49646980142127*^9}, {3.496469836352319*^9, 3.496469836775069*^9}, {
   3.496469963091135*^9, 3.49647001684402*^9}, {3.496477542516479*^9, 
   3.496477550384005*^9}, {3.496650354313772*^9, 3.496650355894565*^9}, {
   3.49665075808911*^9, 3.496650759542059*^9}, {3.496657876462961*^9, 
   3.4966578791175737`*^9}, {3.4966583463939657`*^9, 3.496658346665208*^9}, {
   3.4966587882841187`*^9, 3.496658805104665*^9}, {3.4966597276432943`*^9, 
   3.496659728047866*^9}, {3.503749201303896*^9, 3.503749202238029*^9}, {
   3.50374924986973*^9, 3.503749252121971*^9}, {3.503749337387515*^9, 
   3.503749372680214*^9}, 3.503749545096548*^9, {3.503749580655982*^9, 
   3.503749583166862*^9}, {3.503750046945923*^9, 3.503750058629827*^9}, {
   3.50375020374404*^9, 3.503750207078822*^9}, {3.523356732312647*^9, 
   3.523356733496735*^9}}],

Cell[BoxData[
 RowBox[{"-", "2.9253445955409636`"}]], "Output",
 CellChangeTimes->{
  3.503749205439028*^9, 3.503749352707995*^9, 3.503749549404921*^9, 
   3.503749583744555*^9, {3.503749670219243*^9, 3.503749681714902*^9}, 
   3.503750010027368*^9, {3.5037500479045267`*^9, 3.503750059134489*^9}, {
   3.503750116074856*^9, 3.503750143320324*^9}, {3.5037502043140697`*^9, 
   3.503750207596382*^9}, 3.503750384653706*^9, 3.503750598778737*^9, {
   3.50375092662428*^9, 3.503750933562202*^9}, 3.50375172839445*^9, {
   3.503753032327792*^9, 3.503753045947122*^9}, {3.523356797261673*^9, 
   3.5233568063885193`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multibin Entropy", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
   3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
   3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
   3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
   3.496465134383539*^9}, {3.4964702841062937`*^9, 3.496470382443359*^9}, {
   3.496470438598978*^9, 3.496470483069792*^9}, {3.496471059569688*^9, 
   3.496471071910974*^9}, {3.496479272590764*^9, 3.496479272955422*^9}, {
   3.496661624522215*^9, 3.496661632010087*^9}, 3.523357316452704*^9, 
   3.523362816510746*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hmb", "[", 
   RowBox[{"\"\<D\>\"", ",", "\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"P", "[", "\"\<D\>\"", "]"}]], 
   RowBox[{"(", " ", 
    RowBox[{
     RowBox[{"prombsExt", "[", 
      RowBox[{
       RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
       RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Log", "[", 
          RowBox[{"fe", "[", "#", "]"}], "]"}]}], "&"}], ",", "\[Epsilon]", 
       ",", 
       RowBox[{"L", "-", "1"}]}], "]"}], "-", 
     RowBox[{"prombs", "[", 
      RowBox[{
       RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"P", "[", "\"\<B\>\"", "]"}], 
          RowBox[{"P", "[", "\"\<D\>\"", "]"}]], "]"}], 
        RowBox[{"P", "[", "\"\<B\>\"", "]"}]}], ",", 
       RowBox[{"L", "-", "1"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hmb", "[", 
   RowBox[{"\"\<D\>\"", ",", "0.00000001"}], "]"}], "//", "N"}]}], "Input",
 CellChangeTimes->{
  3.496580419556892*^9, {3.4966376258314247`*^9, 3.496637692361895*^9}, {
   3.4966377226312447`*^9, 3.49663772278649*^9}, 3.496661670154684*^9, 
   3.4966617432445183`*^9, {3.49666178558864*^9, 3.4966618042700653`*^9}, 
   3.496661893459689*^9, {3.496662044042412*^9, 3.496662049808971*^9}, {
   3.4966622763837633`*^9, 3.496662286347228*^9}, {3.496668117107709*^9, 
   3.496668153374399*^9}, {3.496668185094246*^9, 3.496668201627405*^9}, {
   3.496668668054443*^9, 3.4966687410810137`*^9}, {3.496668932157918*^9, 
   3.4966689474076977`*^9}, {3.4966689803292923`*^9, 3.496668990576262*^9}, {
   3.496669223197332*^9, 3.496669243155364*^9}, {3.496669370133439*^9, 
   3.496669379958873*^9}, 3.496669416247388*^9, {3.4966694524259787`*^9, 
   3.4966694563542*^9}, {3.496669567017495*^9, 3.496669569237661*^9}, {
   3.496669614255384*^9, 3.496669616202814*^9}, {3.496669682856832*^9, 
   3.496669685517418*^9}, {3.496670007138133*^9, 3.496670009415145*^9}, {
   3.496670570536068*^9, 3.496670577339024*^9}, {3.496673886702998*^9, 
   3.496673909071484*^9}, {3.496686687920739*^9, 3.496686702153689*^9}, {
   3.497090261311306*^9, 3.497090264578868*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.07395132960491727`", ",", "0.6403398663920876`", ",", 
   "0.9182327678093458`", ",", "0.7638845309827816`", ",", 
   "0.47501812724676656`", ",", "0.20287157415114196`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4966739145399942`*^9, 3.4966844698877277`*^9, {3.4966866904006023`*^9, 
   3.496686702705415*^9}, {3.49708994210489*^9, 3.4970899483723907`*^9}, 
   3.4970902655800877`*^9, {3.523357319476161*^9, 3.523357334979591*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Hmb", "[", 
         RowBox[{"\"\<D\>\"", ",", "\[Epsilon]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0.00001", ",", "0.0000001"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", 
      RowBox[{
       SubscriptBox["H", "MB"], 
       RowBox[{"(", "D", ")"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4966738089217863`*^9, 3.496673863109997*^9}, {
   3.496673911677567*^9, 3.49667392273241*^9}, {3.4966740026537657`*^9, 
   3.496674055800757*^9}, {3.496674104091559*^9, 3.496674137261588*^9}, 
   3.496674750444585*^9, {3.4966819773146772`*^9, 3.4966819913210287`*^9}, {
   3.496682296450192*^9, 3.496682304290491*^9}, {3.496682352915197*^9, 
   3.4966823570188417`*^9}, {3.4970901972375174`*^9, 3.497090212348106*^9}, {
   3.497090316527699*^9, 3.497090318801729*^9}, {3.497090396195805*^9, 
   3.497090420626243*^9}, {3.497090533005816*^9, 3.497090536686102*^9}, {
   3.497090567568115*^9, 3.4970906049497232`*^9}, 3.539599488318377*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJw903s0lGkcB3A50VRyqOQkbCKhThs2Kfo224WO0pZKm8ZxWOJUlKItaxHp
KrusrVzmYmbM7FSTVju5ZEuupctgxm2iGTMTZSl1XMqh9tmz5+mP97znc973
fZ7f8/t9X7uwwwERhgYGBuHk+u++ubgy7317AvrZxgNbrzKY//sC3hhZWscR
H0+bNTxilwPvvsNb8788z4PB6N3EauJLgzLeWD0PJY+nSV9/eV+IOiar2yyX
wQyZH+E7nChGmrhmlmcu/f4a7oidEULsumnumyG3m3CIFMacyaXr3ULSgAVX
SpxaFtp4PK4EC5My5Mpcuv5fSO8zN5ggPrCt3CZeLoPnVM4K+zy6XymyzywL
9SPepTeLPeZSjtNp97Ji8+j+FUgJDau+SuydEFUbm16JOdGT7+/n0XruQSO4
Zt9H7GhWZXlEcx/qz8G7TPNpfVUQds1LX0k8TXFxZSn7AUynKmWsfFpvNRY4
XelNI55grwrx2FIDD49Iy+v5tP5a2L5229xCPBSlOyf7UIuycdOTH/Ppeerg
N/BWsrCAwXzp/kvJN6J6OHKVKt8Cer4GGCdXzTxM3PlpTdftnQ/Rv1rmfbmA
nvcRAsOl0X8TP3vUa+Q+pRHbHhZz9AX0/I1oEMvkM9kMZnVO9tclNx9jX0K1
gTub9uMJMp07XIOIS0Ow15X1FJ22I2Gn2LQ/z5AyYpHzB/F1l/7UW9PlQPLa
Ojmb9kuOU0nRo6PETeN+bVf2NWFLJn+JLYf2rwlDNurvNxH7aRYe3OPWjGVN
dhcOcWg/m1G/9uDd34hr60Y/z5vegmBJ+UAFh/a3BVKuua2WeN31Jzlt6hZk
1Md8N51L+63AhFNLygri8l/5zpfvKFCRiJI9XNp/JY4+K9YlEbsfP3Fv9yUl
/KWOFiIunYcSHqlFPk+Jpfu27bQIb8WHapcTw1w6n1as3lgqWcBjMJ2+dXil
XNOGskC/5+t5dF5tqLDXmRwg5juOJ+aYtyN+cSqyeHR+7VCtXnKkjNjapMl8
16t2GPygLFTz6Dw74LTovMK4kMG8/K5INOd+B9g3NxgtL6Tz7cS4n+Gq3cTm
7T95KX7vRLJJY1RiIZ23CqYZV/MExBcrdzRlH1LBcFbMk8ZCOn8VbHp8P70j
NuIviQjY8Bw1Vi4r5vNpHp6jf+/sMCZx8tnJj+ZWXaiRGOZE8mk+uuDU/aEu
k3j8kCKzeagL1pPDYzI+zUs3Kj3GnLuJ4wIk9lkN3Xh0dAprqoDm5wWiR8wy
lxK/WZVctp3zAs0+TlUBAponNWL4Pu9PEkfZ7PY3i1ej0euAQ6GA5ksNk+Cc
wIfEsacs3vUt1sDzWP25twKaNw0al36qmCdkMJfHpdz1zdLg5wveg2uFNH8a
8CJSv4ogHtj/T7p4QoMbVvIdGUKaxx4Yh9qdvk0s2Ru4fVpUD1gnEu6ohDSf
PUhzV72aUsRg7t/6wCpS0YNYQ+YC5yKaVy1CnaX+24nt1y17WQ8txrLsUn4s
ovnVwjM2v4RDrHG9Uux4TYvNEuuXdUU0z1oEKQWWg8RsB8OEMxY6KBa5+c0V
0XzrEDSzIdGLOMgyemNvig4zekOLw0Q07zpMBhtpzxNbzugw9RnQIbBVOvdP
Ec2/Hv2DLN8O4taJ9Z1Fe/QI8Zqd8FlE/wc9wjvlNxzFDGb2W6nAqEaPyqfZ
an8x/T/0EBWzZscT/wtlI/MH
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 3.075},
  Frame->True,
  FrameLabel->{
    FormBox["\[Epsilon]", TraditionalForm], 
    FormBox[
     RowBox[{"D", " ", 
       SubscriptBox["H", "MB"]}], TraditionalForm]},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.496673896454206*^9, 3.49667394567437*^9, {3.496674109453353*^9, 
   3.496674139672961*^9}, 3.496674773710044*^9, 3.49668215113195*^9, 
   3.496682324627624*^9, 3.496682386887191*^9, 3.497089982131624*^9, {
   3.497090206089397*^9, 3.4970902218240137`*^9}, 3.497090338313962*^9, {
   3.4970904082252398`*^9, 3.497090437696422*^9}, 3.497090546264235*^9, 
   3.497090583664501*^9, 3.49709062341383*^9, 3.52335733943081*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HmbLApprox", "[", 
   RowBox[{"\"\<D\>\"", ",", "\[Epsilon]1_", ",", "\[Epsilon]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p1", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"P", "[", "\"\<D\>\"", "]"}]], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"prombsExt", "[", 
          RowBox[{
           RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
           RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"fe", "[", "#", "]"}], "]"}]}], "&"}], ",", 
           "\[Epsilon]1", ",", 
           RowBox[{"L", "-", "1"}]}], "]"}], "-", 
         RowBox[{"prombs", "[", 
          RowBox[{
           RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{"P", "[", "\"\<B\>\"", "]"}], 
              RowBox[{"P", "[", "\"\<D\>\"", "]"}]], "]"}], 
            RowBox[{"P", "[", "\"\<B\>\"", "]"}]}], ",", 
           RowBox[{"L", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"P", "[", "\"\<D\>\"", "]"}]], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"prombsExt", "[", 
          RowBox[{
           RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
           RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"fe", "[", "#", "]"}], "]"}]}], "&"}], ",", 
           "\[Epsilon]2", ",", 
           RowBox[{"L", "-", "1"}]}], "]"}], "-", 
         RowBox[{"prombs", "[", 
          RowBox[{
           RowBox[{"A", "[", "L", "]"}], ",", "fe", ",", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{"P", "[", "\"\<B\>\"", "]"}], 
              RowBox[{"P", "[", "\"\<D\>\"", "]"}]], "]"}], 
            RowBox[{"P", "[", "\"\<B\>\"", "]"}]}], ",", 
           RowBox[{"L", "-", "1"}]}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p1", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"p2", "-", "p1"}], 
        RowBox[{"\[Epsilon]2", "-", "\[Epsilon]1"}]], "\[Epsilon]1"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.497090024439394*^9, 3.497090137381073*^9}, {
  3.497157703913783*^9, 3.497157707319497*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Vanilla", " ", "method"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.497090840775796*^9, 3.4970908523488197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plus", "@@", 
  RowBox[{"Hmb", "[", 
   RowBox[{"\"\<D\>\"", ",", "0.00000001"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4970908576380243`*^9, 3.497090884081019*^9}}],

Cell[BoxData["3.0742981961870406`"], "Output",
 CellChangeTimes->{{3.4970908555393677`*^9, 3.497090885114312*^9}, 
   3.523357353482894*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Linear", " ", "Approximation"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.497090831154993*^9, 3.4970908365805492`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plus", "@@", 
  RowBox[{"HmbLApprox", "[", 
   RowBox[{"\"\<D\>\"", ",", "0.0002", ",", "0.0001"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.497090139431209*^9, 3.4970901838769817`*^9}, {
  3.497090245646327*^9, 3.49709024758918*^9}, {3.4970906238902473`*^9, 
  3.49709062567842*^9}, {3.497090679171998*^9, 3.4970906903021107`*^9}, {
  3.497090804904557*^9, 3.497090806405328*^9}, {3.497090934348549*^9, 
  3.497090983688286*^9}, {3.497105251924819*^9, 3.497105266785091*^9}, {
  3.497105529143942*^9, 3.497105541626058*^9}, {3.4971577120098743`*^9, 
  3.497157714249711*^9}}],

Cell[BoxData["3.0740973254144492`"], "Output",
 CellChangeTimes->{{3.497090151198812*^9, 3.497090184581246*^9}, 
   3.497090248569098*^9, 3.497090627597726*^9, {3.497090681677066*^9, 
   3.497090691130158*^9}, 3.497090807237597*^9, {3.497090936369279*^9, 
   3.497090984338056*^9}, {3.497105256241803*^9, 3.497105267451335*^9}, {
   3.497105530396044*^9, 3.497105542355811*^9}, 3.523357355718355*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Exact", " ", "Solution"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.497090793619681*^9, 3.497090798133195*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"Hmb", "[", 
      RowBox[{"\"\<D\>\"", ",", "\[Epsilon]"}], "]"}]}], ",", 
    RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.497090740018845*^9, 3.4970907755961113`*^9}}],

Cell[BoxData["3.074290719976544`"], "Output",
 CellChangeTimes->{{3.497090744398876*^9, 3.497090776293696*^9}, 
   3.523357360802153*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["KL-Divergence", "Section",
 CellChangeTimes->{{3.496307482554467*^9, 3.496307514033782*^9}, {
   3.496307582655335*^9, 3.496307604654868*^9}, {3.496314538543949*^9, 
   3.4963145737171087`*^9}, {3.49631469648182*^9, 3.4963146977841*^9}, {
   3.49639167126974*^9, 3.4963916743368273`*^9}, {3.49646512541617*^9, 
   3.496465134383539*^9}, {3.4964702841062937`*^9, 3.496470382443359*^9}, {
   3.496470438598978*^9, 3.496470483069792*^9}, {3.496471059569688*^9, 
   3.496471071910974*^9}, {3.496479272590764*^9, 3.496479272955422*^9}, {
   3.496661624522215*^9, 3.496661632010087*^9}, 3.523357316452704*^9, 
   3.523362816510746*^9, {3.5395859257150583`*^9, 3.539585927855522*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"expectation", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"evidenceref", ",", "evidence"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evidenceref", "=", 
       RowBox[{"P", "[", "\"\<D\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"successes", "[", 
          RowBox[{"[", "x", "]"}], "]"}], "++"}], ",", 
        RowBox[{
         RowBox[{"failures", "[", 
          RowBox[{"[", "x", "]"}], "]"}], "++"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"evidence", "=", 
       RowBox[{"P", "[", "\"\<D\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"y", "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"successes", "[", 
          RowBox[{"[", "x", "]"}], "]"}], "--"}], ",", 
        RowBox[{
         RowBox[{"failures", "[", 
          RowBox[{"[", "x", "]"}], "]"}], "--"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      FractionBox["evidence", "evidenceref"]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"utility", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "fc", ",", "fn", ",", "fs", ",", "p"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{"expectation", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fc", "[", 
       RowBox[{"bij_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "=", 
          RowBox[{"bij", "/.", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"i_", ",", "j_"}]], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "\[LessEqual]", "x"}], "\[And]", 
            RowBox[{"x", "\[LessEqual]", "j"}], "\[And]", 
            RowBox[{"y", "\[Equal]", "z"}]}], ",", "1", ",", "0"}], "]"}]}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fn", "[", "bij_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]"}], ",", 
          RowBox[{
           RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fs", "[", "bij_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "=", 
          RowBox[{"bij", "/.", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"i_", ",", "j_"}]], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          FractionBox[
           RowBox[{"Beta", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]", "+", 
              RowBox[{"fc", "[", 
               RowBox[{"bij", ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]", "+", 
              RowBox[{"fc", "[", 
               RowBox[{"bij", ",", "2"}], "]"}]}]}], "]"}], 
           RowBox[{"Beta", "[", 
            RowBox[{"\[Sigma]", ",", "\[Gamma]"}], "]"}]], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", " ", "\[LessEqual]", "x"}], "\[And]", 
             RowBox[{"x", "\[LessEqual]", "j"}]}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"fn", "[", "bij", "]"}], 
               RowBox[{
                RowBox[{"ns", "[", "bij", "]"}], "+", "\[Sigma]", "+", 
                RowBox[{"nf", "[", "bij", "]"}], "+", "\[Gamma]"}]], "/", 
              "p"}], "]"}], ",", "1"}], "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"N", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"P", "[", "\"\<D\>\"", "]"}]], 
        RowBox[{"Plus", "@@", 
         RowBox[{"prombs", "[", 
          RowBox[{
           RowBox[{"A", "[", "L", "]"}], ",", "fs", ",", 
           RowBox[{"P", "[", "\"\<B\>\"", "]"}], ",", 
           RowBox[{"L", "-", "1"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "result"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.539586689749557*^9, 3.539586826102455*^9}, {
   3.539587029576686*^9, 3.539587056374249*^9}, {3.5395871598297253`*^9, 
   3.539587319112866*^9}, {3.53958747402984*^9, 3.53958748326923*^9}, {
   3.539587600867917*^9, 3.5395876011699057`*^9}, {3.539587645289709*^9, 
   3.539587647001718*^9}, {3.53959316385163*^9, 3.539593249479196*^9}, {
   3.539593294078697*^9, 3.539593295004369*^9}, {3.5395935980433493`*^9, 
   3.539593602319353*^9}, {3.539593776498488*^9, 3.539593901679681*^9}, {
   3.539593952982333*^9, 3.5395939599655313`*^9}, {3.5395940034549522`*^9, 
   3.539594006756722*^9}, {3.539594037049487*^9, 3.539594053008292*^9}, {
   3.539594098642997*^9, 3.539594201435614*^9}, {3.539594292306752*^9, 
   3.539594368374608*^9}, {3.539594468227063*^9, 3.5395944892788258`*^9}, {
   3.539596846528338*^9, 3.539596854680303*^9}, {3.539596884779642*^9, 
   3.5395968881861486`*^9}, {3.539596940257105*^9, 3.539596946193355*^9}, {
   3.539597184535509*^9, 3.5395971927279367`*^9}, {3.5395982863725986`*^9, 
   3.539598299903285*^9}, {3.539598342228716*^9, 3.539598381175701*^9}, {
   3.5395990435379477`*^9, 3.5395990469949503`*^9}, {3.539599098862274*^9, 
   3.539599105903164*^9}, 3.539599394183326*^9, 3.539599478710688*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"utility", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "L"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.539587339581822*^9, 3.539587344918872*^9}, {
  3.5395875090944233`*^9, 3.539587537034686*^9}, {3.539587608527504*^9, 
  3.539587619421504*^9}, {3.53958765302243*^9, 3.5395876678217154`*^9}, {
  3.5395877883472033`*^9, 3.539587795000609*^9}, {3.539592223589242*^9, 
  3.539592224690825*^9}, {3.5395971868198757`*^9, 3.539597188650016*^9}, {
  3.539597480996517*^9, 3.539597483956792*^9}, {3.5395982135024652`*^9, 
  3.539598214170485*^9}, {3.539599164924778*^9, 3.539599198890416*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.001544956499711686`", ",", "0.0021136082221034943`", ",", 
     "0.003130100927529789`", ",", "0.012737236508765256`", ",", 
     "0.00493714588934394`", ",", "0.0022865721001816886`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.000664496037389506`", ",", "0.000976714716612858`", ",", 
     "0.0015629686228709457`", ",", "0.009401542038970331`", ",", 
     "0.007864682269200798`", ",", "0.004208387039439126`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.539597189080361*^9, 3.53959719456557*^9}, {
   3.539597481739624*^9, 3.539597484464933*^9}, 3.5395982145831614`*^9, 
   3.539598288918738*^9, 3.539598368885808*^9, 3.539599050833468*^9, 
   3.539599111087839*^9, {3.539599183169434*^9, 3.539599199530055*^9}, 
   3.539599398739892*^9, 3.539599494344583*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1231, 810},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 162, 3, 72, "Section"],
Cell[732, 27, 1816, 56, 141, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2585, 88, 141, 2, 72, "Section"],
Cell[2729, 92, 2553, 60, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5319, 157, 524, 7, 72, "Section"],
Cell[5846, 166, 1974, 53, 156, "Input"],
Cell[7823, 221, 1826, 44, 127, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9686, 270, 453, 6, 72, "Section"],
Cell[10142, 278, 1611, 36, 138, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11790, 319, 433, 6, 72, "Section"],
Cell[CellGroupData[{
Cell[12248, 329, 1482, 30, 66, "Input"],
Cell[13733, 361, 1199, 21, 29, "Output"],
Cell[14935, 384, 915, 13, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15887, 402, 564, 14, 29, "Input"],
Cell[16454, 418, 446, 10, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16949, 434, 683, 9, 72, "Section"],
Cell[17635, 445, 1780, 46, 66, "Input"],
Cell[CellGroupData[{
Cell[19440, 495, 1651, 31, 29, "Input"],
Cell[21094, 528, 616, 10, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21759, 544, 638, 9, 72, "Section"],
Cell[CellGroupData[{
Cell[22422, 557, 2260, 48, 77, "Input"],
Cell[24685, 607, 479, 9, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25201, 621, 1497, 30, 102, "Input"],
Cell[26701, 653, 2653, 51, 241, "Output"]
}, Open  ]],
Cell[29369, 707, 2599, 70, 181, "Input"],
Cell[31971, 779, 163, 3, 29, "Input"],
Cell[CellGroupData[{
Cell[32159, 786, 192, 4, 29, "Input"],
Cell[32354, 792, 140, 2, 29, "Output"]
}, Open  ]],
Cell[32509, 797, 169, 3, 29, "Input"],
Cell[CellGroupData[{
Cell[32703, 804, 600, 10, 29, "Input"],
Cell[33306, 816, 400, 5, 29, "Output"]
}, Open  ]],
Cell[33721, 824, 161, 3, 29, "Input"],
Cell[CellGroupData[{
Cell[33907, 831, 320, 8, 29, "Input"],
Cell[34230, 841, 137, 2, 29, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34416, 849, 683, 9, 72, "Section"],
Cell[35102, 860, 6492, 159, 500, "Input"],
Cell[CellGroupData[{
Cell[41619, 1023, 776, 15, 29, "Input"],
Cell[42398, 1040, 859, 18, 48, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
